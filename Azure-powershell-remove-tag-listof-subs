# Import the Az module (make sure it's installed)
Import-Module Az

# List of subscription names to process
$subscriptionNames = @(
    "SubscriptionName1",
    "SubscriptionName2",
    "SubscriptionName3"
)

# Specify the name of the tag to remove
$tagToRemove = "TagNameToRemove"

# Loop through each subscription by name
foreach ($subscriptionName in $subscriptionNames) {
    try {
        # Get the subscription ID by name
        $subscription = Get-AzSubscription | Where-Object { $_.Name -eq $subscriptionName }

        if ($null -eq $subscription) {
            Write-Host "Subscription '$subscriptionName' not found." -ForegroundColor Red
            continue
        }

        # Set the current subscription context
        Set-AzContext -SubscriptionId $subscription.Id

        Write-Host "Processing Subscription: $subscriptionName"

        # Get all resources in the subscription
        $resources = Get-AzResource

        foreach ($resource in $resources) {
            # Check if the resource has the tag to remove
            if ($resource.Tags -and $resource.Tags.ContainsKey($tagToRemove)) {
                # Remove the tag
                $newTags = $resource.Tags
                $newTags.Remove
