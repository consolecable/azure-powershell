# Connect to Azure AD
Connect-AzureAD

# Define the search parameters
$keyword = "xxxx"

# Get all users matching the UPN criteria
$users = Get-AzureADUser -Filter "startswith(UserPrincipalName, '$keyword')"

# Create an empty list to store the user names
$userList = @()

# Iterate through each user and add their display name to the list
foreach ($user in $users) {
    $userList += $user.DisplayName
}

# Display the list of users
$userList

# Disconnect from Azure AD
Disconnect-AzureAD
